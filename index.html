<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Second Brain Lab · SBL Toolkit</title>
  <style>
    :root {
      --bg: #0b1020; --bg2: #0f1730; --card: #0f1a33;
      --text: #e9eefc; --muted: #b9c3e6; --line: rgba(255,255,255,.10);
      --accent: #6ea8ff; --r: 18px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: -apple-system, system-ui, sans-serif;
      color: var(--text); background: linear-gradient(180deg, var(--bg), var(--bg2));
      min-height: 100vh;
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 28px 18px; }
    header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 14px 16px; border: 1px solid var(--line); border-radius: var(--r);
      background: rgba(255,255,255,.04); backdrop-filter: blur(10px);
    }
    .btn {
      border: 1px solid var(--line); background: rgba(255,255,255,.06); color: var(--text);
      padding: 10px 16px; border-radius: 12px; cursor: pointer; font-weight: 900; font-size: 13px;
    }
    .btn.primary { background: var(--accent); color: #fff; border: none; }
    .hero { margin: 40px 0 24px; text-align: center; }
    .hero h1 { font-size: 36px; margin-bottom: 12px; }
    .hero p { color: var(--muted); }
    .authbar {
      margin: 20px 0; display: flex; align-items: center; justify-content: space-between;
      padding: 16px 20px; border: 1px solid var(--line); border-radius: var(--r);
      background: rgba(255,255,255,.02);
    }
    
    /* 카드 5개 배치를 위해 3열 그리드로 변경 (반응형 대응) */
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 24px; }
    
    .card {
      border: 1px solid var(--line); border-radius: var(--r);
      background: rgba(255,255,255,.05); padding: 28px; opacity: 0.4; filter: grayscale(1);
      transition: 0.3s ease; text-align: center;
    }
    .card.unlocked { opacity: 1; filter: grayscale(0); border-color: var(--accent); }
    .card h2 { margin-top: 0; }
    .action {
      display: block; margin-top: 20px; padding: 12px; border-radius: 12px;
      text-decoration: none; font-weight: 900; color: #666; background: #222;
      pointer-events: none; transition: 0.2s;
    }
    .action.active { background: var(--accent); color: #fff; pointer-events: auto; }
    footer { margin-top: 60px; text-align: center; font-size: 12px; opacity: 0.4; }
    
    /* 모바일 반응형: 화면이 좁아지면 2열 -> 1열로 변경 */
    @media (max-width: 900px) { .grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="font-weight:900; letter-spacing:-0.5px;">SBL Toolkit</div>
      <div>
        <button class="btn primary" id="loginBtn">Google 로그인</button>
        <button class="btn" id="logoutBtn" style="display:none;">로그아웃</button>
      </div>
    </header>

    <section class="hero">
      <h1 id="hTitle">업무용 툴킷</h1>
      <p id="hMsg">지정된 관리자 계정으로 로그인해 주세요.</p>
    </section>

    <div class="authbar">
      <div id="userInfo" style="font-weight:700;">접속 대기 중...</div>
      <div id="statusChip" style="font-size:12px; color:var(--muted)">GUEST</div>
    </div>

    <section class="grid">
      <div class="card" id="c1">
        <h2>📚 북마크</h2>
        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:0;">업무용 링크 모음</p>
        <a class="action" id="a1" href="./bookmark/">실행하기</a>
      </div>
      <div class="card" id="c2">
        <h2>📰 IT 뉴스</h2>
        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:0;">RSS 뉴스 리더</p>
        <a class="action" id="a2" href="./it-news/">실행하기</a>
      </div>
      <div class="card" id="c3">
        <h2>🧾 Tracker</h2>
        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:0;">인사이트 아카이빙</p>
        <a class="action" id="a3" href="./tracker/">실행하기</a>
      </div>
      <div class="card" id="c4">
        <h2>🎯 빅스톤</h2>
        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:0;">연간 목표 & 만다라트</p>
        <a class="action" id="a4" href="./bitstone/">실행하기</a>
      </div>
      <div class="card" id="c5">
        <h2>🧠 마인드맵</h2>
        <p style="font-size:0.9rem; color:var(--muted); margin-bottom:0;">아이디어 시각화 도구</p>
        <a class="action" id="a5" href="./mindmap/">실행하기</a>
      </div>
    </section>

    <footer>&copy; Second Brain Lab. 업무 전용 공간입니다.</footer>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

    // 통합된 firebaseConfig
    const firebaseConfig = {
      apiKey: "AIzaSyAd08tVXgWZ2_dg3jzvhawmH4jtolRmfhY",
      authDomain: "itnews-82b60.firebaseapp.com",
      databaseURL: "https://itnews-82b60-default-rtdb.firebaseio.com",
      projectId: "itnews-82b60",
      storageBucket: "itnews-82b60.firebasestorage.app",
      messagingSenderId: "719267588761",
      appId: "1:719267588761:web:3c4607cb799620f9446608"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const ALLOWED = "eundang@gmail.com";

    document.getElementById("loginBtn").onclick = () => signInWithPopup(auth, new GoogleAuthProvider());
    document.getElementById("logoutBtn").onclick = () => signOut(auth);

    onAuthStateChanged(auth, (user) => {
      const isAllowed = user && user.email.toLowerCase() === ALLOWED;
      
      // 카드 및 버튼 ID 목록 업데이트 (c5, a5 추가)
      const ids = ["c1", "c2", "c3", "c4", "c5"];
      const btnIds = ["a1", "a2", "a3", "a4", "a5"];

      if (isAllowed) {
        document.getElementById("hTitle").innerText = "반갑습니다, 대표님";
        document.getElementById("hMsg").innerText = "SBL Toolkit의 모든 권한이 활성화되었습니다.";
        document.getElementById("userInfo").innerText = user.displayName + " (" + user.email + ")";
        document.getElementById("statusChip").innerText = "관리자 인증됨";
        document.getElementById("statusChip").style.color = "#6ea8ff";
        document.getElementById("loginBtn").style.display = "none";
        document.getElementById("logoutBtn").style.display = "block";
        ids.forEach(id => document.getElementById(id).classList.add("unlocked"));
        btnIds.forEach(id => document.getElementById(id).classList.add("active"));
      } else {
        if (user) { 
          alert("권한이 없는 계정입니다. eundang@gmail.com으로 다시 로그인해 주세요.");
          signOut(auth); 
        }
        document.getElementById("loginBtn").style.display = "block";
        document.getElementById("logoutBtn").style.display = "none";
        document.getElementById("userInfo").innerText = "접속 대기 중...";
        document.getElementById("statusChip").innerText = "GUEST";
        ids.forEach(id => document.getElementById(id).classList.remove("unlocked"));
        btnIds.forEach(id => document.getElementById(id).classList.remove("active"));
      }
    });
  </script>
</body>
</html>
